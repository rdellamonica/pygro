<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Fitting relativistic orbits to data" href="S2_MCMC.html" /><link rel="prev" title="Ellis wormhole" href="Wormhole.html" />

    <link rel="shortcut icon" href="../_static/pygro-icon.ico"/><!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Null geodesics in Kerr spacetime - Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=0745d1ac" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/github_style.css?v=1093691d" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=83708512" />
    
    


<style>
  body {
    --color-code-background: #0d1117;
  --color-code-foreground: #e6edf3;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/pygro-logo.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/pygro-logo-dark.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../create_metric.html">Define your own space-time</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../integrate_geodesic.html">Integrate a geodesic in PyGRO</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Integrate a geodesic in PyGRO</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../geodesics/null_geodesic.html"><cite>Null geodesic integration</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../geodesics/timelike_geodesic.html"><cite>Time-like geodesic integration</cite></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../define_observer.html">Define a space-time Observer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrating_orbits.html">Integrating physical orbits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualize.html">Visualize the results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrators.html">Integrators</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Notebooks:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Schwarzschild-Precession.html">Orbital precession</a></li>
<li class="toctree-l1"><a class="reference internal" href="Schwarzschild-PhotonOrbit.html">Unstable photon orbit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Schwarzschild-ISCO.html">Circular orbits</a></li>
<li class="toctree-l1"><a class="reference internal" href="Wormhole.html">Ellis wormhole</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Null geodesics in Kerr spacetime</a></li>
<li class="toctree-l1"><a class="reference internal" href="S2_MCMC.html">Fitting relativistic orbits to data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../metricengine.html"><code class="docutils literal notranslate"><span class="pre">Metric</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../geodesicengine.html"><code class="docutils literal notranslate"><span class="pre">GeodesicEngine</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../geodesic.html"><code class="docutils literal notranslate"><span class="pre">Geodesic</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../observer.html"><code class="docutils literal notranslate"><span class="pre">Observer</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../orbit.html"><code class="docutils literal notranslate"><span class="pre">Orbit</span></code></a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/rdellamonica/pygro/blob/master/docs/source/examples/Kerr-Photons.ipynb?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/rdellamonica/pygro/edit/master/docs/source/examples/Kerr-Photons.ipynb" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="Null-geodesics-in-Kerr-spacetime">
<h1>Null geodesics in Kerr spacetime<a class="headerlink" href="#Null-geodesics-in-Kerr-spacetime" title="Link to this heading">¶</a></h1>
<p>In this example notebook, we want to study geodesics in the <code class="docutils literal notranslate"><span class="pre">null</span></code> case around a Kerr black hole, to show the capability of PyGRO to correctly reproduce known results from textbooks and also work with axisymmetric spacetimes.</p>
<p>Let’s start by importing the necessary modules:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pygro</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>

<span class="c1"># We will need to directly access and manipulate symbolic elements in the Metric object, so we import sympy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="c1"># We will solve for the critical impact parameters numerically, so we import a root findind routine from scipy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">fsolve</span>
</pre></div>
</div>
</div>
<p>Let’s define the Kerr metric in Boyer-Lindquist coordinates</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ds^2 = -\left(1-\frac{2Mr}{\Sigma}\right)dt^2-\frac{4Mar\sin^2\theta}{\Sigma}dtd\phi+\frac{\Sigma}{\Delta}dr^2+\Sigma d\theta^2+\left(r^2+a^2+\frac{2Ma^2r\sin^2\theta}{\Sigma}\right)\sin^2\theta d\phi^2\]</div>
</div>
<p>with <span class="math notranslate nohighlight">\(\Sigma \equiv r^2+a^2\cos^2\theta\)</span> and <span class="math notranslate nohighlight">\(\Delta \equiv r^2-2Mr+a\)</span>.</p>
<p>In the limit <span class="math notranslate nohighlight">\(M\to0\)</span>, the Kerr metric reduces to flat Minkowski space-time in oblate spheroidal coordinates, that are related to standard flat-space cartesian coordiantes via the relations <span class="math notranslate nohighlight">\(x=\sqrt{r^2+a^2}\sin\theta\cos\phi\)</span>, <span class="math notranslate nohighlight">\(y=\sqrt{r^2+a^2}\sin\theta\sin\phi\)</span> and <span class="math notranslate nohighlight">\(z=r\cos\theta\)</span>. We will use these flat-space limit cartesian coordinates for the purpose of visualization of the geodesics resulting from our calculations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Kerr spacetime&quot;</span>
<span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;theta&quot;</span><span class="p">,</span> <span class="s2">&quot;phi&quot;</span><span class="p">]</span>

<span class="n">transform_functions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;t&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sqrt(r**2+a**2)*sin(theta)*cos(phi)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sqrt(r**2+a**2)*sin(theta)*sin(phi)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;r*cos(theta)&quot;</span>
<span class="p">]</span>

<span class="n">line_element</span> <span class="o">=</span> <span class="s2">&quot;-(1-2*M*r/(Sigma(r,theta)))*dt**2+Sigma(r,theta)/Delta(r)*dr**2+Sigma(r,theta)*dtheta**2+(r**2+a**2+2*M*r*a**2/Sigma(r,theta)*sin(theta)**2)*sin(theta)**2*dphi**2-4*M*r*a*sin(theta)**2/Sigma(r,theta)*dt*dphi&quot;</span>

<span class="n">Sigma</span> <span class="o">=</span> <span class="s2">&quot;r**2+a**2*cos(theta)**2&quot;</span>
<span class="n">Delta</span> <span class="o">=</span> <span class="s2">&quot;r**2-2*M*r+a**2&quot;</span>

<span class="n">metric</span> <span class="o">=</span> <span class="n">pygro</span><span class="o">.</span><span class="n">Metric</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">,</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">,</span>
    <span class="n">line_element</span> <span class="o">=</span> <span class="n">line_element</span><span class="p">,</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">transform_functions</span><span class="p">,</span>
    <span class="n">Sigma</span> <span class="o">=</span> <span class="n">Sigma</span><span class="p">,</span>
    <span class="n">Delta</span> <span class="o">=</span> <span class="n">Delta</span><span class="p">,</span>
    <span class="n">M</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
(PyGRO) INFO: Initializing Kerr spacetime.
(PyGRO) INFO: Calculating inverse metric.
(PyGRO) INFO: Calculating symbolic equations of motion.
(PyGRO) INFO: Computing helper functions to normalize 4-velocity.
(PyGRO) INFO: The Metric (Kerr spacetime) has been initialized.
</pre></div></div>
</div>
<p>We have fixed the mass to unity and the spin parameter to <span class="math notranslate nohighlight">\(a=0.5\)</span></p>
<p>Now we define the <code class="docutils literal notranslate"><span class="pre">GeodesicEngine</span></code> with a stopping criterion at the event horizon (we require that <span class="math notranslate nohighlight">\(\Delta &gt; \epsilon\)</span> with <span class="math notranslate nohighlight">\(\epsilon\)</span> a small positive value).</p>
<p>We use in this case the RungeKutta7(8) algorithm to improve the accuracy of the integration of the unstable photon orbits (without having to reduce drastically the maximum step size)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geo_engine</span> <span class="o">=</span> <span class="n">pygro</span><span class="o">.</span><span class="n">GeodesicEngine</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;autowrap&quot;</span><span class="p">,</span> <span class="n">integrator</span><span class="o">=</span><span class="s2">&quot;rkf78&quot;</span><span class="p">)</span>
<span class="n">geo_engine</span><span class="o">.</span><span class="n">set_stopping_criterion</span><span class="p">(</span><span class="s2">&quot;r**2-2*M*r+a**2 &gt; 1e-4&quot;</span><span class="p">,</span> <span class="s2">&quot;horizon&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
(PyGRO) WARNING: No Metric object passed to the Geodesic Engine constructor. Using last initialized Metric (Kerr spacetime) instead.
(PyGRO) INFO: Linking Kerr spacetime to the Geodesic Engine
(PyGRO) INFO: Metric linking complete.
</pre></div></div>
</div>
<p>We now want to assign initial conditions to null <code class="docutils literal notranslate"><span class="pre">Geodesics</span></code> on the equatorial plane (for simplicity) of the Kerr spacetime. On this plane, one can uniquely assign initial conditions to null geodesics at a given point by defining an impact parameter</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[b\equiv \frac{L}{E}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(E\)</span> are the azimuthal angular momentum and specific energy, respectively, defined by</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[E = -\frac{\partial \mathcal{L}}{\partial \dot{t}},\qquad L = \frac{\partial \mathcal{L}}{\partial \dot{\phi}},\]</div>
</div>
<p>with <span class="math notranslate nohighlight">\(\mathcal{L}\)</span> being the test particle lagrangian. These quantities can be easly defined in PyGRO with:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L_eq</span> <span class="o">=</span> <span class="n">metric</span><span class="o">.</span><span class="n">subs_functions</span><span class="p">(</span><span class="n">metric</span><span class="o">.</span><span class="n">Lagrangian</span><span class="p">())</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;theta&#39;</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;u_theta&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span> <span class="c1"># We are computing the lagrangian on the equatorial plane</span>

<span class="n">E</span> <span class="o">=</span> <span class="o">-</span><span class="n">L_eq</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">metric</span><span class="o">.</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">L_eq</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">metric</span><span class="o">.</span><span class="n">u</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>An interesting classical result of geodesic motion in the Kerr space-time that we want to recover in PyGRO is the existence of critical impact parameters <span class="math notranslate nohighlight">\(b_c\)</span> on the equatorial plane for which the null geodesic results in an unstable photon orbit. The critical impact parameter <span class="math notranslate nohighlight">\(b_c\)</span> satisfies the equation</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(b_c+a)^3=27M^2(b_c-a),\]</div>
</div>
<p>for any given value of <span class="math notranslate nohighlight">\(a\)</span>. For <span class="math notranslate nohighlight">\(a=0\)</span> (non-rotating case) the only solution is <span class="math notranslate nohighlight">\(b_c=\sqrt{27}M\)</span> which corresponds to the circular photon orbit wit <span class="math notranslate nohighlight">\(r=3M\)</span> that we have obtained in Section <span class="math">\ref{sec:photon_orbit}</span> for the Schwarzschild case. For <span class="math notranslate nohighlight">\(0&lt;a&lt;1\)</span>, due to frame dragging, the equation has two solutions, <span class="math notranslate nohighlight">\(b_{c,\pm}\)</span> with opposite signs, one (<span class="math notranslate nohighlight">\(b_{c,+}\)</span>) for prograde (null geodesics with <span class="math notranslate nohighlight">\(L\)</span> having the same sign of <span class="math notranslate nohighlight">\(a\)</span>) and the
other (<span class="math notranslate nohighlight">\(b_{c,-}\)</span>) for retrograde (with <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(a\)</span> having opposite signs) null geodesics. This means that there exist two different circular photon orbits on the equatorial plane at radii</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[r_\pm = 2M\left[1+\cos\left(\frac{2}{3}\arccos\frac{\pm a}{M}\right)\right].\]</div>
</div>
<p>Null geodesics with <span class="math notranslate nohighlight">\(b_{c,-}&lt;b&lt;b_{c,+}\)</span> will be bound to the central black hole and cross the event horizon. Null geodesics with impact parameter outside this interval will escape to infinity. Null geodesics with <span class="math notranslate nohighlight">\(b_{c,\pm}\)</span> will approach asymptotically the unstable circular orbits.</p>
<p>Let’s define a function to solve numerically for <span class="math notranslate nohighlight">\(b_c\)</span> given the value of <span class="math notranslate nohighlight">\(a\)</span> defined in the <code class="docutils literal notranslate"><span class="pre">Metric</span></code> object and for the two possible directions. We use as initial guess <span class="math notranslate nohighlight">\(\pm\sqrt{27}M\)</span> (i.e. the critical impact parameter for the Schwarzschild case) and use the <code class="docutils literal notranslate"><span class="pre">scipy</span></code> function <code class="docutils literal notranslate"><span class="pre">fsolce</span></code> to obtain the value of <span class="math notranslate nohighlight">\(b_c\)</span> numerically.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_b_c</span><span class="p">(</span><span class="n">prograde</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">prograde</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">27</span><span class="p">),</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">metric</span><span class="o">.</span><span class="n">get_constant</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),))[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Now we define a function that initializes a null geodesic on the equatorial plane, given a value of the impact parameter <span class="math notranslate nohighlight">\(b_0\)</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_geo_from_b</span><span class="p">(</span><span class="n">b_0</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>

    <span class="n">u_t_0</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">u_phi_0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">metric</span><span class="o">.</span><span class="n">evaluate_parameters</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">((</span><span class="n">b</span><span class="o">-</span><span class="n">b_0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;u_t&#39;</span><span class="p">:</span> <span class="n">u_t_0</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="n">r</span><span class="p">}),</span> <span class="n">metric</span><span class="o">.</span><span class="n">u</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">u_r_0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">metric</span><span class="o">.</span><span class="n">evaluate_parameters</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">L_eq</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;u_t&#39;</span><span class="p">:</span> <span class="n">u_t_0</span><span class="p">,</span> <span class="s1">&#39;u_phi&#39;</span><span class="p">:</span> <span class="n">u_phi_0</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="n">r</span><span class="p">}),</span> <span class="n">metric</span><span class="o">.</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">1</span><span class="p">]))</span>

    <span class="n">geo</span> <span class="o">=</span> <span class="n">pygro</span><span class="o">.</span><span class="n">Geodesic</span><span class="p">(</span><span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="n">geo_engine</span><span class="p">)</span>

    <span class="n">geo</span><span class="o">.</span><span class="n">initial_x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">geo</span><span class="o">.</span><span class="n">initial_u</span> <span class="o">=</span> <span class="p">[</span><span class="n">u_t_0</span><span class="p">,</span> <span class="n">u_r_0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">u_phi_0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">geo</span>
</pre></div>
</div>
</div>
<p>The function assumes, without loss of generality, that <span class="math notranslate nohighlight">\(\dot{t}(0)=1\)</span> and uses the definitions of <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(\mathcal{L}\)</span> to solve for the unknown values of <span class="math notranslate nohighlight">\(\dot{\phi}(0)\)</span> and <span class="math notranslate nohighlight">\(\dot{r}(0)\)</span>, then initializes the null geodesic with these values.</p>
<p>Let’s now define a bunch of geodesics starting far away from the observer, e.g. <span class="math notranslate nohighlight">\(r_0=10^3\)</span> and scan several values of the impact parameter.</p>
<p>For example, let’s consider 20 null geodesics between the two critical impact parameters (called in the code <code class="docutils literal notranslate"><span class="pre">b_c_retro</span></code> and <code class="docutils literal notranslate"><span class="pre">b_c_pro</span></code>, respectively) and let’s define an array of 60 geodesics including the critical ones, the 20 between the critical values and with the remaining ones with impact parameters outside the critical interval.</p>
<p>We integrate these geodesics backward in time for a time that is slightly larger than <span class="math notranslate nohighlight">\(r_0\)</span> (in geometrized units) so that the photons can reach the central black hole and also escape (if they can).</p>
<p>We reduce the value of the maximum step size of the integration in correspondence with the critical values to appropriately recover the unstable circular photon orbits:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b_c_retro</span> <span class="o">=</span> <span class="n">get_b_c</span><span class="p">(</span><span class="n">prograde</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">b_c_pro</span> <span class="o">=</span> <span class="n">get_b_c</span><span class="p">(</span><span class="n">prograde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">19</span>

<span class="n">db</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_c_pro</span><span class="o">-</span><span class="n">b_c_retro</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>

<span class="n">b_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">b_c_retro</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">db</span><span class="p">,</span> <span class="n">b_c_pro</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">db</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b_arr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">b_c_retro</span>
<span class="n">b_arr</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b_c_pro</span>

<span class="n">geo_arr</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b_i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">b_arr</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">b_arr</span><span class="p">)</span><span class="si">}</span><span class="s2"> (b = </span><span class="si">{</span><span class="n">b_i</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">geo</span> <span class="o">=</span> <span class="n">get_geo_from_b</span><span class="p">(</span><span class="n">b_i</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">geo_engine</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">geo</span><span class="p">,</span> <span class="mi">1030</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">accuracy_goal</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">precision_goal</span><span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">hmax</span> <span class="o">=</span> <span class="mf">.1</span> <span class="k">if</span> <span class="n">b_i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">b_c_retro</span><span class="p">,</span> <span class="n">b_c_pro</span><span class="p">]</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;bw&quot;</span><span class="p">)</span>
    <span class="n">geo_arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
60/60 (b = 14.87))
</pre></div></div>
</div>
<p>We can finally visualize the results on the equatorial plane</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4.2</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">))</span>

<span class="k">for</span> <span class="n">b_i</span><span class="p">,</span> <span class="n">geo</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">b_arr</span><span class="p">,</span> <span class="n">geo_arr</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">b_i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">b_c_pro</span><span class="p">,</span> <span class="n">b_c_retro</span><span class="p">]:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span>
    <span class="k">elif</span> <span class="n">b_c_retro</span> <span class="o">&lt;</span> <span class="n">b_i</span> <span class="o">&lt;</span> <span class="n">b_c_pro</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#2fb389&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#dedede&quot;</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">metric</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1000</span> <span class="k">if</span> <span class="n">b_i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">b_c_retro</span><span class="p">,</span> <span class="n">b_c_pro</span><span class="p">]</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>


<span class="n">r_H</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">metric</span><span class="o">.</span><span class="n">get_constant</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="n">x_bh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r_H</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">metric</span><span class="o">.</span><span class="n">get_constant</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">y_bh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r_H</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">metric</span><span class="o">.</span><span class="n">get_constant</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x_bh</span><span class="p">,</span> <span class="n">y_bh</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">lim</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">lim</span><span class="p">,</span> <span class="n">lim</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">lim</span><span class="p">,</span> <span class="n">lim</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$ ($M$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$y$ ($M$)&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
(PyGRO) WARNING: Ignoring fixed x limits to fulfill fixed data aspect with adjustable data limits.
(PyGRO) WARNING: Ignoring fixed y limits to fulfill fixed data aspect with adjustable data limits.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Kerr-Photons_17_1.png" src="../_images/examples_Kerr-Photons_17_1.png" />
</div>
</div>
<p>As expected theoretically, photons with <span class="math notranslate nohighlight">\(b_{c,-}&lt;b&lt;b_{c,+}\)</span> (green lines) cross the horizon, while the others (gray lines) escape to infinity. Geodesics with impact parameter matching the critical values (black lines) approach the unstable circular orbits for the prograde and retrograde cases. The asymmetry of the region corresponding to bound photons with respect to a photon initially aligned with the central black hole (<span class="math notranslate nohighlight">\(b=0\)</span>) ultimately causes the asymmetry of the Kerr shadow.</p>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="S2_MCMC.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Fitting relativistic orbits to data</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="Wormhole.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Ellis wormhole</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Riccardo Della Monica
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/rdellamonica/pygro" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=292eb321"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>