<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Integrate a geodesic in PyGRO" href="integrate_geodesic.html" /><link rel="prev" title="Getting started" href="getting_started.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Define your own space-time - PyGRO 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=0745d1ac" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/github_style.css?v=1093691d" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=83708512" />
    
    


<style>
  body {
    --color-code-background: #0d1117;
  --color-code-foreground: #e6edf3;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyGRO 1.0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/pygro-logo.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/pygro-logo-dark.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyGRO 1.0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Define your own space-time</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="integrate_geodesic.html">Integrate a geodesic in PyGRO</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Integrate a geodesic in PyGRO</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="geodesics/null_geodesic.html"><cite>Null geodesic integration</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="geodesics/timelike_geodesic.html"><cite>Time-like geodesic integration</cite></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="define_observer.html">Define a space-time Observer</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualize.html">Visualize the results</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrators.html">Integrators</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/Schwarzschild-Precession.html">Orbital precession</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/Schwarzschild-PhotonOrbit.html">Unstable photon orbit</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/Schwarzschild-ISCO.html">Innermost Stable Circilar Orbit</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="metricengine.html"><cite>Metric</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="geodesicengine.html"><cite>GeodesicEngine</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="geodesic.html"><cite>Geodesic</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="observer.html"><cite>Observer</cite></a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/create_metric.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="define-your-own-space-time">
<h1>Define your own space-time<a class="headerlink" href="#define-your-own-space-time" title="Link to this heading">¶</a></h1>
<p>In this tutorial we will go through all the different methods in PyGRO for the generation of a <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric" title="pygro.metric_engine.Metric"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Metric()</span></code></a> object that describes a particular space-time metric.
For the sake of simplicity, we will devote this tutorial to the Schwarzschild solution, describing the spherically symmetric spacetime around a point-like particle with mass <span class="math notranslate nohighlight">\(M\)</span>.
When expressed in Schwarzschild coordinates <span class="math notranslate nohighlight">\((t, r, \theta, \phi)\)</span> the line element describing the geometry of this spacetime is described by</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ds^2 = -\left(1-\frac{2M}{r}\right)dt^2+\left(1-\frac{2M}{r}\right)^{-1}dr^2+r^2(d\theta^2+\sin^2\theta d\phi^2),\]</div>
</div>
<p>where we have assumed that <span class="math notranslate nohighlight">\(G=c=1\)</span> and, hence, the radial coordinate and spatial distances are expressed in units of gravitational radii <span class="math notranslate nohighlight">\(r_g = GM/c^2\)</span>.</p>
<section id="purely-symbolic-approach">
<h2>Purely symbolic approach<a class="headerlink" href="#purely-symbolic-approach" title="Link to this heading">¶</a></h2>
<p id="symb">In this approach, the <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric" title="pygro.metric_engine.Metric"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Metric()</span></code></a> object will be generated starting from a line element (<code class="docutils literal notranslate"><span class="pre">str</span></code>) which is a function that depends <strong>explicitly</strong> only on the space-time coordinates
and on a given number of <code class="docutils literal notranslate"><span class="pre">constant</span></code> parameters. This means that no <em>auxiliary</em> function of the space-time coordinates is introduced, as will be done in the <a class="reference internal" href="#aux-expr"><span class="std std-ref">Auxiliary expressions approach</span></a>
or <a class="reference internal" href="#aux-func"><span class="std std-ref">Auxiliary functions approach</span></a>.
In order to initialize the <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric" title="pygro.metric_engine.Metric"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Metric()</span></code></a>, we define a <code class="docutils literal notranslate"><span class="pre">list</span></code> of <code class="docutils literal notranslate"><span class="pre">str</span></code> for the spacetime coordinates, and we express the <code class="docutils literal notranslate"><span class="pre">line_element</span></code> as a function of such coordinates <span class="math notranslate nohighlight">\(\{x^\mu\}\)</span> and of their infinitesimal increment <span class="math notranslate nohighlight">\(\{dx^\mu\}\)</span>, indicated with a <code class="docutils literal notranslate"><span class="pre">d</span></code> as prefix
(e.g. for coordinate <code class="docutils literal notranslate"><span class="pre">theta</span></code> the increment is <code class="docutils literal notranslate"><span class="pre">dtheta</span></code>). Additionally, the <code class="docutils literal notranslate"><span class="pre">transform_functions</span></code> list is defined, which contains the symbolic expressions for transformation functions
from the spacetime coordinates in which the <code class="docutils literal notranslate"><span class="pre">line_element</span></code> is expressed to pseudo-cartesian coordinates <span class="math notranslate nohighlight">\((t, x, y, z)\)</span> that are useful to <a class="reference internal" href="visualize.html"><span class="doc">Visualize the results</span></a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Since the <code class="docutils literal notranslate"><span class="pre">line_element</span></code> is converted into a <code class="docutils literal notranslate"><span class="pre">sympy</span></code> expression, a good way to check whether it has been correctly typed,
is to apply the <code class="docutils literal notranslate"><span class="pre">pygro.parse_expr</span></code> function on the <code class="docutils literal notranslate"><span class="pre">line_element</span></code> and check that the mathematical expression is properly interpreted.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pygro</span>

<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Schwarzschild spacetime&quot;</span>
<span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;theta&quot;</span><span class="p">,</span> <span class="s2">&quot;phi&quot;</span><span class="p">]</span>

<span class="n">transform_functions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;t&quot;</span><span class="p">,</span>
    <span class="s2">&quot;r*sin(theta)*cos(phi)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;r*sin(theta)*sin(phi)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;r*cos(theta)&quot;</span>
<span class="p">]</span>

<span class="n">line_element</span> <span class="o">=</span> <span class="s2">&quot;-(1-2*M/r)*dt**2+1/(1-2*M/r)*dr**2+r**2*(dtheta**2+sin(theta)**2*dphi**2)&quot;</span>

<span class="n">metric</span> <span class="o">=</span> <span class="n">pygro</span><span class="o">.</span><span class="nc">Metric</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">,</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">,</span>
    <span class="n">line_element</span> <span class="o">=</span> <span class="n">line_element</span><span class="p">,</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">transform_functions</span><span class="p">,</span>
    <span class="nc">M</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Note that we have passed an additional argument to the Metric constructor <code class="docutils literal notranslate"><span class="pre">(...,</span> <span class="pre">M</span> <span class="pre">=</span> <span class="pre">1)</span></code> by which we have set to unity the value of the parameter <span class="math notranslate nohighlight">\(M\)</span> in the metric.
In PyGRO, constant parameters should always be assigned a numerical value. If no argument <code class="docutils literal notranslate"><span class="pre">M</span></code> is passed to the constructor, the user will be prompted to insert one as input:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; Insert value for M:
</pre></div>
</div>
<p>During initialization the code will inform the user about the current state of initialization through the standard output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(PyGRO) INFO: Initializing Schwarzschild spacetime.
(PyGRO) INFO: Calculating inverse metric.
(PyGRO) INFO: Calculating symbolic equations of motion.
(PyGRO) INFO: Computing helper function to normalize 4-velocity.
(PyGRO) INFO: The Metric (Schwarzschild spacetime) has been initialized.
</pre></div>
</div>
<p>The <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric" title="pygro.metric_engine.Metric"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Metric()</span></code></a> performs tensorial operations on the newly generated metric tensor <span class="math notranslate nohighlight">\(g_{\mu\nu}\)</span> (accessible via <code class="xref py py-attr docutils literal notranslate"><span class="pre">Metric.g</span></code>) for computing:</p>
<ul>
<li><p>The inverse metric, accessible via <code class="xref py py-attr docutils literal notranslate"><span class="pre">Metric.g_inv</span></code>;</p></li>
<li><dl>
<dt>The geodesic equations, representing the right-hand side in equation</dt><dd><div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\ddot{x}^\mu = - \Gamma^{\mu}_{\nu\rho}\dot{x}^\nu\dot{x}^\rho\]</div>
</div>
</dd>
</dl>
<p>where, <span class="math notranslate nohighlight">\(\Gamma^{\mu}_{\nu\rho}\)</span> are the Christoffel symbols accessible via <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric.Christoffel" title="pygro.metric_engine.Metric.Christoffel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Christoffel()</span></code></a>.
These four equations are stored into a list accessible via <code class="xref py py-attr docutils literal notranslate"><span class="pre">Metric.eq_u</span></code>.</p>
</li>
<li><dl>
<dt>Two symbolic algebraic expressions for the <span class="math notranslate nohighlight">\(\dot{x}^0\)</span> component of the four velocity derived from the normalization conditions:</dt><dd><div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}g_{\mu\nu}\dot{x}^\mu\dot{x}^\nu = \left\{\begin{array}{ll}
&amp;-1&amp;\qquad\textrm{time-like curve}\\
&amp;0&amp;\qquad\textrm{null curve}\\
\end{array}\right.\end{split}\]</div>
</div>
</dd>
</dl>
<p>These are particularly useful when one needs to retrieve the time-like component of the four-velocity of a massive particle (or, equivalently, the time-like component of a photon wave-vector)
knowing the spatial components of the velocity (which is usually the case). See <a class="reference internal" href="integrate_geodesic.html"><span class="doc">Integrate a geodesic in PyGRO</span></a> for a working example.</p>
</li>
</ul>
</section>
<section id="auxiliary-expressions-approach">
<h2>Auxiliary expressions approach<a class="headerlink" href="#auxiliary-expressions-approach" title="Link to this heading">¶</a></h2>
<p id="aux-expr">In this section we review a different symbolic approach to generate a <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric" title="pygro.metric_engine.Metric"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Metric()</span></code></a> object which, differently than
before, relies on an auxiliary function which has a closed analytical form. Suppose, for the sake of simplicity, that one desires to generate
the same Schwarzschild metric that has been computed in the <a class="reference internal" href="#symb"><span class="std std-ref">Purely symbolic approach</span></a>, but instead of defining it purely symbolically,
one wants to write it using the following expression</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ds^2 = -A(r)dt^2+\frac{1}{A(r)}dr^2+r^2(d\theta^2+\sin^2\theta d\phi^2),\]</div>
</div>
<p>where:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A(r) = \left(1-\frac{2M}{r}\right).\]</div>
</div>
<p>Clearly the new expression is formally equivalent to that in the previous section and one might think that this reformulation is not useful. However, for much more complicated metrics, having the possibility to inject into the metric auxiliary functions whose actual analytic expression is indicated elsewhere can be really useful and allow for neater formulation of the problem. For this reason, in PyGRO a functionality to accept auxiliary functions as part of the metric expression has been introduced. It can be easily accessed by specifying the auxiliary function and its dependency from the spacetime coordinates (e.g. <code class="docutils literal notranslate"><span class="pre">A(r)</span></code> in our case) in the <code class="docutils literal notranslate"><span class="pre">line_element</span></code> and later passing as additional keyword argument, whose name is the functional part of the function, to the <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric" title="pygro.metric_engine.Metric"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Metric()</span></code></a> constructor a <code class="docutils literal notranslate"><span class="pre">str</span></code> containing the symbolic expression of the function (e.g. <code class="docutils literal notranslate"><span class="pre">(...,</span> <span class="pre">A</span> <span class="pre">=</span> <span class="pre">&quot;1-2*M/r&quot;)</span></code>). Again, any constant parameter that is used in the auxiliary expression must be specified as additional keyword argument (e.g. <code class="docutils literal notranslate"><span class="pre">(...,</span> <span class="pre">M</span> <span class="pre">=</span> <span class="pre">1)</span></code>).</p>
<p>Here is what a <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric" title="pygro.metric_engine.Metric"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Metric()</span></code></a> initialization would look like in this case:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Schwarzschild spacetime&quot;</span>
<span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;theta&quot;</span><span class="p">,</span> <span class="s2">&quot;phi&quot;</span><span class="p">]</span>

<span class="n">transform_functions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;t&quot;</span><span class="p">,</span>
    <span class="s2">&quot;r*sin(theta)*cos(phi)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;r*sin(theta)*sin(phi)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;r*cos(theta)&quot;</span>
<span class="p">]</span>

<span class="n">line_element</span> <span class="o">=</span> <span class="s2">&quot;-A(r)*dt**2+1/A(r)*dr**2+r**2*(dtheta**2+sin(theta)**2*dphi**2)&quot;</span>

<span class="nc">A</span> <span class="o">=</span> <span class="s2">&quot;1-2*M/r&quot;</span>

<span class="n">metric</span> <span class="o">=</span> <span class="n">pygro</span><span class="o">.</span><span class="nc">Metric</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">,</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">,</span>
    <span class="n">line_element</span> <span class="o">=</span> <span class="n">line_element</span><span class="p">,</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">transform_functions</span><span class="p">,</span>
    <span class="nc">A</span> <span class="o">=</span> <span class="nc">A</span><span class="p">,</span>
    <span class="nc">M</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Auxiliary expression can also rely on <em>other</em> auxiliary expressions, as long as on metric initialization they are all properly passed to the <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric" title="pygro.metric_engine.Metric"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Metric()</span></code></a> constructor. For example, the previous metric could also be defined as <code class="docutils literal notranslate"><span class="pre">line_element</span> <span class="pre">=</span> <span class="pre">&quot;-A(r)*dt**2+B(r)*dr**2+r**2*(dtheta**2+sin(theta)**2*dphi**2)&quot;</span></code>, provided that the initialization is done with <code class="docutils literal notranslate"><span class="pre">metric</span> <span class="pre">=</span> <span class="pre">pygro.Metric(...,</span> <span class="pre">line_element</span> <span class="pre">=</span> <span class="pre">line_element,</span> <span class="pre">transform</span> <span class="pre">=</span> <span class="pre">transform_functions,</span> <span class="pre">A</span> <span class="pre">=</span> <span class="pre">&quot;1-2*M/r&quot;,</span> <span class="pre">B</span> <span class="pre">=</span> <span class="pre">&quot;1/A(r)&quot;,</span> <span class="pre">M</span> <span class="pre">=</span> <span class="pre">1)</span></code>.</p>
</div>
</section>
<section id="auxiliary-functions-approach">
<h2>Auxiliary functions approach<a class="headerlink" href="#auxiliary-functions-approach" title="Link to this heading">¶</a></h2>
<p id="aux-func">Finally, we have a last approach for the metric initialization, which relies on auxiliary <code class="docutils literal notranslate"><span class="pre">pyfunc</span></code> methods as parts of the line element. This approach is particularly useful when we wish to introduce in the metric functions of the coordinates that do not have an analytic expression and rely on, for example, the solution of an integral or on an interpolated/tabulated function which is not available within the <code class="docutils literal notranslate"><span class="pre">sympy</span></code> module. This approach allows to use any function defined in the <code class="docutils literal notranslate"><span class="pre">__main__</span></code> body of your script as auxiliary function.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>We suggest using the <em>Auxiliary functions approach</em> only when strictly dictated by the problem you want to solve, i.e. only if it is necessary to rely on an external function that cannot be expressed symbolically with an analytic expression. This is because PyGRO reaches its best performances when integrating geodesic equations expressed in a completely symbolic way. More specifically, upon linking of a <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric" title="pygro.metric_engine.Metric"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Metric()</span></code></a> element to a <code class="xref py py-meth docutils literal notranslate"><span class="pre">GeodesicEngine()</span></code>, PyGRO makes use of the built-in <code class="docutils literal notranslate"><span class="pre">sympy</span></code> method <code class="docutils literal notranslate"><span class="pre">autowrap</span></code>, which converts the call to a specific symbolic expression into a C-precompiled binary executable, whereas when presented with a non symbolic expression, it relies on the native-Python <code class="docutils literal notranslate"><span class="pre">sympy</span></code> method <code class="docutils literal notranslate"><span class="pre">lambdify</span></code>. The former <strong>drastically</strong> improves the integration performances.</p>
</div>
<p>In order to correctly initialize a metric using the <em>Auxiliary functions approach</em> the user must take into account the fact that Christoffel symbols and, hence, geodesic equations are computed from the derivatives of the metric coefficients. This means that, while in the purely symbolic approaches the <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric" title="pygro.metric_engine.Metric"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Metric()</span></code></a> deals autonomously with the computation of such derivatives, in the auxiliary functions approach the user should not only pass to the <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric" title="pygro.metric_engine.Metric"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Metric()</span></code></a> constructor the <code class="docutils literal notranslate"><span class="pre">pyfunc</span></code> corresponding to the auxiliary functions reported in the line element, but also its derivatives with respect to all the coordinates on which it explicitly depends. These must be passed as keyword arguments to the metric constructor corresponding to the following syntax:</p>
<p>&gt; <code class="docutils literal notranslate"><span class="pre">&quot;A(r)&quot;</span> <span class="pre">-&gt;</span> <span class="pre">Metric(...,</span> <span class="pre">A</span> <span class="pre">=</span> <span class="pre">[...],</span> <span class="pre">dAdr</span> <span class="pre">=</span> <span class="pre">[...])</span></code></p>
<p>It is important to notice that the <code class="docutils literal notranslate"><span class="pre">pyfunc</span></code> to pass to the metric must be defined as a method depending on four arguments, one for each coordinate, that has to be ordered exactly as the coordinates of the metric.</p>
<p>Here, for example, we initialize the same Schwarzschild metric of the previous examples but using the auxiliary functions approach:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Schwarzschild spacetime&quot;</span>
<span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;theta&quot;</span><span class="p">,</span> <span class="s2">&quot;phi&quot;</span><span class="p">]</span>
<span class="n">line_element</span> <span class="o">=</span> <span class="s2">&quot;-A(r)*dt**2+1/A(r)*dr**2+r**2*(dtheta**2+dphi**2)&quot;</span>
<span class="n">transform</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;t&quot;</span><span class="p">,</span>
    <span class="s2">&quot;r*sin(theta)*cos(phi)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;r*sin(theta)*sin(phi)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;r*cos(theta)&quot;</span>
<span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">A</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <span class="nc">M</span> <span class="o">=</span> <span class="n">metric</span><span class="o">.</span><span class="kp">get_constant</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="nc">M</span><span class="o">/</span><span class="n">r</span>

<span class="k">def</span><span class="w"> </span><span class="nf">dAdr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <span class="nc">M</span> <span class="o">=</span> <span class="n">metric</span><span class="o">.</span><span class="kp">get_constant</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="nc">M</span><span class="o">/</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span>

<span class="n">metric</span> <span class="o">=</span> <span class="n">pygro</span><span class="o">.</span><span class="nc">Metric</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">,</span>
    <span class="n">line_element</span> <span class="o">=</span> <span class="n">line_element</span><span class="p">,</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">,</span>
    <span class="nc">A</span> <span class="o">=</span> <span class="nc">A</span><span class="p">,</span>
    <span class="n">dAdr</span> <span class="o">=</span> <span class="n">dAdr</span><span class="p">,</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">transform</span>
<span class="p">)</span>

<span class="n">metric</span><span class="o">.</span><span class="kp">add_parameter</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notice how we have made use of the <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric.get_constant" title="pygro.metric_engine.Metric.get_constant"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_constant()</span></code></a> method of the <code class="docutils literal notranslate"><span class="pre">Metric</span></code> class to access the <cite>M</cite> parameter inside the metric. In particular, since now the symbolic expression of the line element does not contain any <span class="math notranslate nohighlight">\(M\)</span>, we had to manually add this parameter to the metric by using the <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric.add_parameter" title="pygro.metric_engine.Metric.add_parameter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_parameter()</span></code></a> method. Using this approach, now we can link symbolic parameters of the metric to ones that we need to access from the auxiliary functions.</p>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="integrate_geodesic.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Integrate a geodesic in PyGRO</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="getting_started.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Getting started</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Riccardo Della Monica
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Define your own space-time</a><ul>
<li><a class="reference internal" href="#purely-symbolic-approach">Purely symbolic approach</a></li>
<li><a class="reference internal" href="#auxiliary-expressions-approach">Auxiliary expressions approach</a></li>
<li><a class="reference internal" href="#auxiliary-functions-approach">Auxiliary functions approach</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=8d563738"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>