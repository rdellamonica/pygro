<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Visualize the results" href="visualize.html" /><link rel="prev" title="Define a space-time Observer" href="define_observer.html" />

    <link rel="shortcut icon" href="_static/pygro-icon.ico"/><!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Integrating physical orbits - Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=0745d1ac" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/github_style.css?v=1093691d" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=83708512" />
    
    


<style>
  body {
    --color-code-background: #0d1117;
  --color-code-foreground: #e6edf3;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/pygro-logo.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/pygro-logo-dark.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_metric.html">Define your own space-time</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="integrate_geodesic.html">Integrate a geodesic in PyGRO</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Integrate a geodesic in PyGRO</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="geodesics/null_geodesic.html"><cite>Null geodesic integration</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="geodesics/timelike_geodesic.html"><cite>Time-like geodesic integration</cite></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="define_observer.html">Define a space-time Observer</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Integrating physical orbits</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualize.html">Visualize the results</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrators.html">Integrators</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Notebooks:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/Schwarzschild-Precession.html">Orbital precession</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/Schwarzschild-PhotonOrbit.html">Unstable photon orbit</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/Schwarzschild-ISCO.html">Circular orbits</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/Wormhole.html">Ellis wormhole</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="metricengine.html"><code class="docutils literal notranslate"><span class="pre">Metric</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="geodesicengine.html"><code class="docutils literal notranslate"><span class="pre">GeodesicEngine</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="geodesic.html"><code class="docutils literal notranslate"><span class="pre">Geodesic</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="observer.html"><code class="docutils literal notranslate"><span class="pre">Observer</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="orbit.html"><code class="docutils literal notranslate"><span class="pre">Orbit</span></code></a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/rdellamonica/pygro/blob/master/docs/source/integrating_orbits.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/rdellamonica/pygro/edit/master/docs/source/integrating_orbits.rst" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="integrating-physical-orbits">
<h1>Integrating physical orbits<a class="headerlink" href="#integrating-physical-orbits" title="Link to this heading">¶</a></h1>
<p>The trajectories of massive test particles in PyGRO can be integrated using the low-level <a class="reference internal" href="geodesic.html#pygro.geodesic.Geodesic" title="pygro.geodesic.Geodesic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geodesic</span></code></a> class, by assigning the initial data directly from the values of the space-time coordinates and of the components of the 4-velocity at a given proper time (see <a class="reference internal" href="geodesics/timelike_geodesic.html"><span class="doc">Time-like geodesic integration</span></a>)</p>
<p>Alternatively, one can set the initial conditions by tying the orbit to a physical observer at a given location in space-time and assign initial velocity and direction relative to this observer(see <a class="reference internal" href="define_observer.html"><span class="doc">Define a space-time Observer</span></a>).</p>
<p>In this tutorial we introduce another possibility. The <a class="reference internal" href="orbit.html#pygro.orbit.Orbit" title="pygro.orbit.Orbit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Orbit</span></code></a> class, which is a wrapper for the <a class="reference internal" href="geodesic.html#pygro.geodesic.Geodesic" title="pygro.geodesic.Geodesic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geodesic</span></code></a> class in the <code class="docutils literal notranslate"><span class="pre">&quot;time-like&quot;</span></code> case, allows to set initial conditions for a massive test particle and to integrate its trajectory, by paramterizing the initial position and velocity in a set of Keplerian elements that are familiar to those of classical celestial mechanics.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The functionalities of the <a class="reference internal" href="orbit.html#pygro.orbit.Orbit" title="pygro.orbit.Orbit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Orbit</span></code></a> class and the procedure for assigning initial conditions are guaranteed to work exclusively for spherically symmetric space-times.</p>
</div>
<section id="theoretical-background">
<h2>Theoretical background<a class="headerlink" href="#theoretical-background" title="Link to this heading">¶</a></h2>
<p>The geodesic equations, describing relativistic trajectories of test particles, are a system of four second-order differential equations for four unknown functions that describe the spacetime trajectory of a test particle as a function of an affine parameter. For massive particle, describing time-like trajectories, one can choose affine parameter the proper time of the particle.</p>
<p>A solution to the geodesic equations is uniquely determined once second-order initial conditions are assigned. Namely, one has to specify at a any given proper time <span class="math notranslate nohighlight">\(s_0\)</span> the initial spacetime position of the test particle (<em>e.g.</em> for the Schwarzschild space-time <span class="math notranslate nohighlight">\(t(s_0)\)</span>, <span class="math notranslate nohighlight">\(r(s_0)\)</span>, <span class="math notranslate nohighlight">\(\theta(s_0)\)</span>, <span class="math notranslate nohighlight">\(\phi(s_0)\)</span>) and spacetime 4-velocity (<em>e.g.</em> <span class="math notranslate nohighlight">\(\dot{t}(s_0)\)</span>, <span class="math notranslate nohighlight">\(\dot{r}(s_0)\)</span>, <span class="math notranslate nohighlight">\(\dot{\theta}(s_0)\)</span>, <span class="math notranslate nohighlight">\(\dot{\phi}(s_0)\)</span>). In PyGRO, this is what one should do using the standard <a class="reference internal" href="geodesic.html#pygro.geodesic.Geodesic" title="pygro.geodesic.Geodesic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geodesic</span></code></a> API.</p>
<p>In spherically symmetric space-times (we are considering that the space-time coordinates are <span class="math notranslate nohighlight">\(r\)</span> for the radial coordinate and <span class="math notranslate nohighlight">\((\theta,\,\phi)\)</span> for the latitudinal and azimuthal angles), one can exploit this symmetry to reduce the complexity of the problem. As a matter of fact, one can always perform appropriate rotations to make the trajectory lie on the equatorial plane for the whole duration of the motion. This reduces the number of free parameters, since <span class="math notranslate nohighlight">\(\theta = \pi/ 2\)</span> and <span class="math notranslate nohighlight">\(\dot{\theta} = 0\)</span> are assumed implicitly. Moreover, since the metric components (and thus the geodesic equations) do not explicitly depend on the time coordinate <span class="math notranslate nohighlight">\(t\)</span>, the value <span class="math notranslate nohighlight">\(t(s_0)\)</span> can be chosen arbitrarily, with no impact on the resulting trajectory. Finally, the normalization condition of the 4-velocity for massive test-particles, <span class="math notranslate nohighlight">\(g_{\mu\nu}\dot{x}^\mu\dot{x}^\nu=-1\)</span>, represents a constraint on the initial data, thus allowing to derive one of the components of the 4-velocity as a function of the others.</p>
<p>A complete set of initial data that uniquely identifies a trajectory on the equatorial plane of a spherically symmetric spacetime can thus be (<span class="math notranslate nohighlight">\(r(s_0)\)</span>, <span class="math notranslate nohighlight">\(\phi(s_0)\)</span>, <span class="math notranslate nohighlight">\(\dot{t}(s_0)\)</span>, <span class="math notranslate nohighlight">\(\dot{\phi}(s_0)\)</span>), with <span class="math notranslate nohighlight">\(\dot{r}(s_0)\)</span> fixed by the choice of <span class="math notranslate nohighlight">\(\dot{t}(s_0)\)</span> and <span class="math notranslate nohighlight">\(\dot{\phi}(s_0)\)</span> through the normalization condition.</p>
<p>Instead of fixing the initial conditions directly in terms of these components of the 4-velocity, we introduce a different parameterization in terms of constants of motion. In particular, given the relativistic test-particle Lagrangian, that can be built from the metric tensor</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\mathcal{L} = \frac{1}{2}g_{\mu\nu}\dot{x}^\mu\dot{x}^\nu,\]</div>
</div>
<p>one can obtain in spherically symmetric space-times two constants of motion:</p>
<div class="math-wrapper docutils container" id="equation-el-lagrangian">
<div class="math notranslate nohighlight" id="equation-el-lagrangian">
<span class="eqno">(1)<a class="headerlink" href="#equation-el-lagrangian" title="Link to this equation">¶</a></span>\[\begin{split}E &amp;= -\frac{\partial {\mathcal{L}}}{\partial \dot{t}}\\
L &amp;= \frac{\partial \mathcal{\mathcal{L}}}{\partial \dot{\phi}}\end{split}\]</div>
</div>
<p>And always rewrite the equation of motion on the radial direction as a function</p>
<div class="math-wrapper docutils container" id="equation-dotr2">
<div class="math notranslate nohighlight" id="equation-dotr2">
<span class="eqno">(2)<a class="headerlink" href="#equation-dotr2" title="Link to this equation">¶</a></span>\[\dot{r}^2 = E - V_\textrm{eff}(r; L)\]</div>
</div>
<p>Where we have introduced the effective potential <span class="math notranslate nohighlight">\(V_\textrm{eff}\)</span> which is parametrized by the orbital angular momentum and depends functionally on the radial coordinate <span class="math notranslate nohighlight">\(r\)</span>. A choice of <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(L\)</span> uniquely fixes the evolution of the radial coordiante and specifically defines the radial turning points, <em>i.e.</em> point where <span class="math notranslate nohighlight">\(\dot{r} = 0\)</span>. In the case of quasi-elliptic orbits (which is the case we are interested in, even though the <a class="reference internal" href="orbit.html#pygro.orbit.Orbit" title="pygro.orbit.Orbit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Orbit</span></code></a> class can in general be used for any orbital configuration) we call the two radial turning point the pericenter (identified by radial coordinate <span class="math notranslate nohighlight">\(r_p\)</span>) and the apocenter (identified by <span class="math notranslate nohighlight">\(r_a\)</span>),</p>
<p>We can invert this mapping and introduce two orbital parameters, namely the eccentricity <span class="math notranslate nohighlight">\(e`\)</span> and the semi-major axis <span class="math notranslate nohighlight">\(a\)</span> that have a unique map to the radial turning points</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}r_p &amp;= a(1-e)\\
r_a &amp;= a(1+e)\end{split}\]</div>
</div>
<p>and look for the values of <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(L\)</span> that make <span class="math notranslate nohighlight">\(\dot{r}=0\)</span> at both <span class="math notranslate nohighlight">\(r=r_p\)</span> and <span class="math notranslate nohighlight">\(r=r_a\)</span>, by numerically solving <a class="reference internal" href="#equation-dotr2">(2)</a>.</p>
<a class="only-light reference internal image-reference" href="_images/effective-potential.png"><img alt="Effective potential" class="only-light" src="_images/effective-potential.png" style="width: 100%;" />
</a>
<a class="only-dark reference internal image-reference" href="_images/effective-potential-dark.png"><img alt="Effective potential" class="only-dark" src="_images/effective-potential-dark.png" style="width: 100%;" />
</a>
<p>In the flat space-time limit the orbital parameters that we have introduced perfectly match the concept of semi-major axis and eccentricity classically defined in Newtonian celestial mechanics for Keplerian elliptical orbits. In the General Relativistic case, these parameters depend on the particular choice of coordinates used (for example, in the harmonic gauge of post-Newtonian mechanics, these parameter have a slightly different definition and physical interpretation) and their physical meaning is not uniquely defined in the strong-field regime. They don’t thus have a direct physical meaning, but only serve as a familiar and useful parametrization of initial data.</p>
<p>Once the values of <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(L\)</span> are known, one can invert equations <a class="reference internal" href="#equation-el-lagrangian">(1)</a> to obtain <span class="math notranslate nohighlight">\(\dot{t}\)</span> and <span class="math notranslate nohighlight">\(\dot{\phi}\)</span>. We can now choose wheter to start the integration at apocenter or pericenter and fix the rest of initial conditions from there. For example, if we call <span class="math notranslate nohighlight">\(t_p\)</span> the time of pericenter passage, we have that inital data are</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}t(s_0) &amp;= t_p\\
r(s_0) &amp;= a(1-e)\\
\phi(s_0) &amp;= 0\\
\dot{r}(s_0) &amp;= 0\end{split}\]</div>
</div>
<p>and <span class="math notranslate nohighlight">\(\dot{t}(s_0)\)</span> and <span class="math notranslate nohighlight">\(\dot{\phi}(s_0)\)</span> are derived with the procedure that we have just explained. This completely fixes the initial conditions on the equatorial plane and allows to integrate the geodesic equations numerically.</p>
<p>To go outside the equatorial plane, we can introduce the standard angular orbital parameters:</p>
<ul class="simple">
<li><p><strong>Inclination</strong> (<span class="math notranslate nohighlight">\(i\)</span>) measures how much the orbital plane is inclined with respect to the euqatorial plane of the spherically-symmetric space-time considered. The two planes intersect on a line that is known as emph{line of nodes}. The orbiting object crosses this line two times over one period. The point where it cuts it from below the plane is known as the emph{ascending node}; the point where it cuts it from above is known as emph{descending node}.</p></li>
<li><p><strong>Longitude of the ascending</strong> (<span class="math notranslate nohighlight">\(\Omega\)</span>), which is the angle between the <span class="math notranslate nohighlight">\(x\)</span> axis (<em>i.e.</em> the one identified by <span class="math notranslate nohighlight">\(\theta=\pi/2\)</span> and <span class="math notranslate nohighlight">\(\phi=0\)</span>) and the ascending node.</p></li>
<li><p><strong>Argument of the pericenter</strong> (<span class="math notranslate nohighlight">\(\omega\)</span>) between the line of nodes and the semi-major axis of the orbit, specifically its pericenter, ovver the orbital plane.</p></li>
</ul>
<a class="only-light reference internal image-reference" href="_images/orbital-parameters.png"><img alt="Illustration of the orbital parameters" class="only-light" src="_images/orbital-parameters.png" style="width: 100%;" />
</a>
<a class="only-dark reference internal image-reference" href="_images/orbital-parameters-dark.png"><img alt="Illustration of the orbital parameters" class="only-dark" src="_images/orbital-parameters-dark.png" style="width: 100%;" />
</a>
<p>These angles correspond to three subsequent rotations that bring the orbit into the desired reference frame:</p>
<ul class="simple">
<li><p>a rotation <span class="math notranslate nohighlight">\(R_1\)</span> around the <span class="math notranslate nohighlight">\(z\)</span> axis by an angle <span class="math notranslate nohighlight">\(-\omega\)</span> (the minus sign is due to the fact that by definition <span class="math notranslate nohighlight">\(\omega\)</span> points <em>towards</em> <span class="math notranslate nohighlight">\(x\)</span> and not <em>from</em> it);</p></li>
<li><p>a rotation <span class="math notranslate nohighlight">\(R_2\)</span> by an angle <span class="math notranslate nohighlight">\(-i\)</span> around the new <span class="math notranslate nohighlight">\(x\)</span> axis, corresponding to the line of nodes;</p></li>
<li><p>a rotation <span class="math notranslate nohighlight">\(R_3\)</span> around the <span class="math notranslate nohighlight">\(z\)</span> axis by an angle <span class="math notranslate nohighlight">\(-\Omega\)</span>.</p></li>
</ul>
<p>The three rotations are applied to both the initial position and velocity before integrating the geodesic.</p>
</section>
<section id="orbits-in-pygro">
<h2>Orbits in PyGRO<a class="headerlink" href="#orbits-in-pygro" title="Link to this heading">¶</a></h2>
<p>In PyGRO the <a class="reference internal" href="orbit.html#pygro.orbit.Orbit" title="pygro.orbit.Orbit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Orbit</span></code></a> class incorporates all the previously explained theoretical background and, being based on the combination of symbolic comutaions of the <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric" title="pygro.metric_engine.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a> object and numerical root-finding routines, generalizes it for an arbitrary spherically-symmetric spacetime.</p>
<p>After having defined a <a class="reference internal" href="metricengine.html#pygro.metric_engine.Metric" title="pygro.metric_engine.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a> (<a class="reference internal" href="create_metric.html"><span class="doc">Define your own space-time</span></a>) and having linked it to a <code class="xref py py-class docutils literal notranslate"><span class="pre">GeodesicEngine</span></code> (<a class="reference internal" href="integrate_geodesic.html"><span class="doc">Integrate a geodesic in PyGRO</span></a>), defininf an <a class="reference internal" href="orbit.html#pygro.orbit.Orbit" title="pygro.orbit.Orbit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Orbit</span></code></a> is as simple as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">orbit</span> <span class="o">=</span> <span class="n">pygro</span><span class="o">.</span><span class="nc">Orbit</span><span class="p">()</span>
</pre></div>
</div>
<p>One can then assign the orbital parameters (or pass them to the <a class="reference internal" href="orbit.html#pygro.orbit.Orbit" title="pygro.orbit.Orbit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Orbit</span></code></a> constructur as a dictionary <code class="docutils literal notranslate"><span class="pre">orbital_parameters</span></code>, see the detailed API documentation) by specifying</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">orbit</span><span class="o">.</span><span class="kp">set_orbital_parameters</span><span class="p">(</span><span class="n">t_P</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, we have assigned a periceneter passage coordinate time of <code class="docutils literal notranslate"><span class="pre">t_P=0</span></code>, a semi-major axis <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">200</span></code> and an eccentricity <code class="docutils literal notranslate"><span class="pre">e=0.8</span></code>. This is regarded as a minimal set of orbital parameters that uniquely identifiy an orbit. Alternatively, one could have specified <code class="docutils literal notranslate"><span class="pre">t_A</span></code>, the time of apocenter passage, which would have fixed initial conditions at apocenter, instead. Additionally, one can fix values for the angular orbital parameters <code class="docutils literal notranslate"><span class="pre">(...,</span> <span class="pre">i</span> <span class="pre">=</span> <span class="pre">...,</span> <span class="pre">omega</span> <span class="pre">=</span> <span class="pre">...,</span> <span class="pre">Omega</span> <span class="pre">=</span> <span class="pre">...)</span></code>, which have to be specified in radians. These are not mandatory, and one can leave them blank. PyGRO will automatically fix them to zero (implying that orbit lies on the equatorial plane, <span class="math notranslate nohighlight">\(\theta=\pi/2\)</span>, with its initial major-axis oriented along the pseudo-cartesian x-axis, corresponding to an angle <span class="math notranslate nohighlight">\(\phi=0\)</span>).</p>
<p>At this point one can integrate the orbit, using the <a class="reference internal" href="orbit.html#pygro.orbit.Orbit.integrate" title="pygro.orbit.Orbit.integrate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">integrate()</span></code></a> method which requires as arguments the lenght of proper time interval on which to integrate and the inital step. Additionally, one can pass all the arguments of the specific geodesic integrator chosen in the <a class="reference internal" href="geodesicengine.html#pygro.geodesic_engine.GeodesicEngine" title="pygro.geodesic_engine.GeodesicEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeodesicEngine</span></code></a> initialization and a precision tolerance for the root-finding algorithm of the initial conditions (see the <a class="reference internal" href="orbit.html#pygro.orbit.Orbit" title="pygro.orbit.Orbit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Orbit</span></code></a> documentation)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">orbit</span><span class="o">.</span><span class="kp">integrate</span><span class="p">(</span><span class="mf">2e5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">accuracy_goal</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">precision_goal</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<p>Behind the curtains, this is where, before carrying out the numerical integration of the particle’s trajectory, PyGRO performs the calculations to convert the orbital parameters into initial conditions for the geodesic. In case this procedure fails (for whatever reason, be it theoretical impossibility to map between the given set of orbital parameters and initial geodesic conditons or failure of the root-finding algorithm) the procedure falls back to assignign intial conditions based on Kepler’s laws (which of course don’t have general validity in a relativistic scenario).</p>
<p>An example orbit that can be obtained in this case is shown here:</p>
<a class="reference internal image-reference" href="_images/orbit-example-1.png"><img alt="Example orbit" src="_images/orbit-example-1.png" style="width: 100%;" />
</a>
<p>but we refer to the example notebooks <a class="reference internal" href="examples/Schwarzschild-ISCO.html"><span class="doc">Circular orbits</span></a> and <a class="reference internal" href="examples/Schwarzschild-Precession.html"><span class="doc">Orbital precession</span></a> for in-depth examples of the functionality of the <a class="reference internal" href="orbit.html#pygro.orbit.Orbit" title="pygro.orbit.Orbit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Orbit</span></code></a> API.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="visualize.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Visualize the results</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="define_observer.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Define a space-time Observer</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Riccardo Della Monica
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/rdellamonica/pygro" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Integrating physical orbits</a><ul>
<li><a class="reference internal" href="#theoretical-background">Theoretical background</a></li>
<li><a class="reference internal" href="#orbits-in-pygro">Orbits in PyGRO</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=292eb321"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>