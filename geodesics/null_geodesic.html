<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Time-like geodesic integration" href="timelike_geodesic.html" /><link rel="prev" title="Integrate a geodesic in PyGRO" href="../integrate_geodesic.html" />

    <link rel="shortcut icon" href="../_static/pygro-icon.ico"/><!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Null geodesic integration - Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=0745d1ac" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/github_style.css?v=1093691d" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=83708512" />
    
    


<style>
  body {
    --color-code-background: #0d1117;
  --color-code-foreground: #e6edf3;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/pygro-logo.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/pygro-logo-dark.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../create_metric.html">Define your own space-time</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../integrate_geodesic.html">Integrate a geodesic in PyGRO</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Integrate a geodesic in PyGRO</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#"><cite>Null geodesic integration</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="timelike_geodesic.html"><cite>Time-like geodesic integration</cite></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../define_observer.html">Define a space-time Observer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrating_orbits.html">Integrating physical orbits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualize.html">Visualize the results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrators.html">Integrators</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Notebooks:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/Schwarzschild-Precession.html">Orbital precession</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Schwarzschild-PhotonOrbit.html">Unstable photon orbit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Schwarzschild-ISCO.html">Circular orbits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Wormhole.html">Ellis wormhole</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Kerr-Photons.html">Null geodesics in Kerr spacetime</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/S2_MCMC.html">Fitting relativistic orbits to data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../metricengine.html"><code class="docutils literal notranslate"><span class="pre">Metric</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../geodesicengine.html"><code class="docutils literal notranslate"><span class="pre">GeodesicEngine</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../geodesic.html"><code class="docutils literal notranslate"><span class="pre">Geodesic</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../observer.html"><code class="docutils literal notranslate"><span class="pre">Observer</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../orbit.html"><code class="docutils literal notranslate"><span class="pre">Orbit</span></code></a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/rdellamonica/pygro/blob/master/docs/source/geodesics/null_geodesic.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/rdellamonica/pygro/edit/master/docs/source/geodesics/null_geodesic.rst" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="null-geodesic-integration">
<h1><cite>Null geodesic integration</cite><a class="headerlink" href="#null-geodesic-integration" title="Link to this heading">¶</a></h1>
<p>Null geodesics describe in General Relativity the space-time trajectory of massless particles (e.g. photons). Numerically integrating the equations of motions describing the dynamics of these particles allows performing <em>ray-tracing</em>, i.e. to reconstruct the paths that light-rays would follow on a curved space-time around a massive object.</p>
<p>In this tutorial we will examine the procedure in PyGRO to perform this operation and obtain the numerically integrated trajectory of a photon (or a bunch of them) in space-time.</p>
<p>Let’s assume that we have a <a class="reference internal" href="../metricengine.html#pygro.metric_engine.Metric" title="pygro.metric_engine.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a> object appropriately initialized following the <a class="reference internal" href="../create_metric.html"><span class="doc">Define your own space-time</span></a> tutorial and thus representing the Schwarzschild metric. Moreover, we assume that the we have initialized a  <a class="reference internal" href="../geodesicengine.html#pygro.geodesic_engine.GeodesicEngine" title="pygro.geodesic_engine.GeodesicEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeodesicEngine</span></code></a> object and linked it to the Schwarzschild metric, as done in the <a class="reference internal" href="../integrate_geodesic.html"><span class="doc">Integrate a geodesic in PyGRO</span></a> tutorial. This also means that we have set a <a class="reference internal" href="../geodesicengine.html#pygro.geodesic_engine.StoppingCriterion" title="pygro.geodesic_engine.StoppingCriterion"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCriterion</span></code></a> to stop the integration if a geodesic goes very close to the event horizon of the metric (resulting in a <code class="docutils literal notranslate"><span class="pre">Geodesic.exit</span> <span class="pre">=</span> <span class="pre">&quot;horizon&quot;</span></code> exit).</p>
<p>Now we can initialize a new null <a class="reference internal" href="../geodesic.html#pygro.geodesic.Geodesic" title="pygro.geodesic.Geodesic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geodesic</span></code></a> in this set-up by simply defining a new object</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geo</span> <span class="o">=</span> <span class="n">pygro</span><span class="o">.</span><span class="nc">Geodesic</span><span class="p">(</span><span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="n">geo_engine</span><span class="p">)</span>
</pre></div>
</div>
<p>Before being able to integrate the geodesic, we have to fix an initial position and 4-velocity for the geodesic. These quantities are stored in the <code class="docutils literal notranslate"><span class="pre">Geodesic.initial_x</span></code> and <code class="docutils literal notranslate"><span class="pre">Geodesic.initial_u</span></code> properties, respectively. While we can fix these properties by hand, it is more convenient to do so using the helper functions of the <a class="reference internal" href="../geodesic.html#pygro.geodesic.Geodesic" title="pygro.geodesic.Geodesic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geodesic</span></code></a> class, that guarantee the normalization constraint imposed by the geodesic type.</p>
<p>We can hence use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geo</span><span class="o">.</span><span class="kp">set_starting_point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">geo</span><span class="o">.</span><span class="kp">set_starting_4velocity</span><span class="p">(</span><span class="n">u1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">u2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">u3</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
<p>to fix the initial position of the geodesic at a distance <span class="math notranslate nohighlight">\(r=50M\)</span> from the black hole, on the equatorial plane (<span class="math notranslate nohighlight">\(\theta = \pi/2\)</span>) and, without loss of generality at a coordinate time <span class="math notranslate nohighlight">\(t=0\)</span> and along the line <span class="math notranslate nohighlight">\(\phi = 0\)</span>. Using the <a class="reference internal" href="../geodesic.html#pygro.geodesic.Geodesic.set_starting_4velocity" title="pygro.geodesic.Geodesic.set_starting_4velocity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_starting_4velocity()</span></code></a> method, we have fixed an initial 4-velocity starting from its components <span class="math notranslate nohighlight">\(u_r=-1\)</span>, <span class="math notranslate nohighlight">\(u_\theta=0\)</span> and <span class="math notranslate nohighlight">\(u_\phi=0.01\)</span>, and we are letting the internal helper function of the <a class="reference internal" href="../geodesic.html#pygro.geodesic.Geodesic" title="pygro.geodesic.Geodesic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geodesic</span></code></a> autonomously retrieve the corresponding value of <span class="math notranslate nohighlight">\(u_t\)</span> that satisfies the normalization condition at the given initial point.</p>
<p>We will be alerted of the successful initialization of the <a class="reference internal" href="../geodesic.html#pygro.geodesic.Geodesic" title="pygro.geodesic.Geodesic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geodesic</span></code></a> object by the output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; (PyGRO) INFO: Setting starting point
&gt;&gt;&gt; (PyGRO) INFO: Setting initial 4-velocity.
</pre></div>
</div>
<p>Now we are ready to carry out the integration of the <a class="reference internal" href="../geodesic.html#pygro.geodesic.Geodesic" title="pygro.geodesic.Geodesic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geodesic</span></code></a> following the scheme depicted in <a class="reference internal" href="../integrate_geodesic.html"><span class="doc">Integrate a geodesic in PyGRO</span></a>.</p>
<p>Hence, we can call the method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geo_engine</span><span class="o">.</span><span class="kp">integrate</span><span class="p">(</span><span class="n">geo</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">accuracy_goal</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">precision_goal</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
<p>to integrate the <a class="reference internal" href="../geodesic.html#pygro.geodesic.Geodesic" title="pygro.geodesic.Geodesic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geodesic</span></code></a> object <code class="docutils literal notranslate"><span class="pre">geo</span></code> up to a value of the affine parameter <span class="math notranslate nohighlight">\(\tau = 50\)</span>, starting with an initial step of 1. The <code class="docutils literal notranslate"><span class="pre">verbose</span> <span class="pre">=</span> <span class="pre">True</span></code> keyword argument makes the integration verbose which will alert us of the status of the integration. We have also used specific precisiona and accuracy tolerances, for which we suggest reading the <a class="reference internal" href="../integrators.html"><span class="doc">Integrators</span></a> tutorial. In this case, we will be logged</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; (PyGRO) INFO: Starting integration.
&gt;&gt;&gt; (PyGRO) INFO: Integration completed in 0.038264 s with result &#39;done&#39;.
</pre></div>
</div>
<p>signaling that the integration has been succesful, and has not met any horizon or stopping criterion (since it has an exit string <code class="docutils literal notranslate"><span class="pre">'done'</span></code>).</p>
<p>We can visualize the resulting geodesic following the <a class="reference internal" href="../visualize.html"><span class="doc">Visualize the results</span></a> tutorial:</p>
<a class="reference internal image-reference" href="../_images/null_geodesic_example_1.png"><img alt="Null geodesic deflected by the central black hole" src="../_images/null_geodesic_example_1.png" style="width: 100%;" />
</a>
<p>The geodesic obtained by the integration propagates in the gravitational field of the Schwarzschild black hole and gets deflected by a small angle as it approaches the central object.</p>
<p>We can try and repeat the integration by changing the initial 4-velocity, reducing its <span class="math notranslate nohighlight">\(\theta\)</span> component (<em>e.g.</em> by a factor 5) and making it plunge into the horizon.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geo_2</span> <span class="o">=</span> <span class="n">pygro</span><span class="o">.</span><span class="nc">Geodesic</span><span class="p">(</span><span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="n">geo_engine</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">geo_2</span><span class="o">.</span><span class="kp">set_starting_point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">geo_2</span><span class="o">.</span><span class="kp">set_starting_4velocity</span><span class="p">(</span><span class="n">u1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">u2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">u3</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">)</span>
<span class="n">geo_engine</span><span class="o">.</span><span class="kp">integrate</span><span class="p">(</span><span class="n">geo_2</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>resulting in</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(PyGRO) INFO: Integration completed in 0.10361 s with result &#39;horizon&#39;.
</pre></div>
</div>
<p>which can be visualized as</p>
<a class="reference internal image-reference" href="../_images/null_geodesic_example_2.png"><img alt="Null geodesic being captured by the central black hole" src="../_images/null_geodesic_example_2.png" style="width: 100%;" />
</a>
<p>We can play around by changing the starting point of the geodesic and its 4-velocity to see how the the integrated geodesic changes depending on the initial data. Nevertheless, directly using the <a class="reference internal" href="../geodesic.html#pygro.geodesic.Geodesic.set_starting_4velocity" title="pygro.geodesic.Geodesic.set_starting_4velocity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_starting_4velocity()</span></code></a> to fix the initial components of the 4-velocity has its drawebacks as one directly fixes the derivatives of the space-time coordinates at the initial time which in principle have no physical meaning. A much more physical way of fixing the initial conditions is to choose a physical observer, using the <a class="reference internal" href="../observer.html#pygro.observer.Observer" title="pygro.observer.Observer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Observer</span></code></a> class and use it to fix initial conditions for null geodesics starting from a specific direction in the observer’s reference frame.</p>
<p>This will be explained in more details in the <a class="reference internal" href="../define_observer.html"><span class="doc">Define a space-time Observer</span></a> tutorial.</p>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="timelike_geodesic.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><cite>Time-like geodesic integration</cite></div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../integrate_geodesic.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Integrate a geodesic in PyGRO</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Riccardo Della Monica
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/rdellamonica/pygro" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=292eb321"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>